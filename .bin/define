#!/bin/env bash
# Written using Ecosia AI Chat (OpenAi) and modified by hand multiple times -- 'cause AI is dumb sometimes

# Default language is Italian
language="it"

# Check if the "-e" option is provided to search the English Wikipedia
if [ "$1" == "-e" ]; then
  language="en"
  shift
fi

# Check if an argument is provided
if [ $# -eq 0 ]; then
  echo "Please provide a search term as an argument."
  exit 1
fi

# URL encode the search term
search_term=$(echo "$*" | sed 's/ /%20/g')

# Fetch the Wikipedia page content
page_content=$(curl -sL "https://$language.wikipedia.org/w/api.php?&action=query&format=json&prop=extracts&exintro&explaintext&titles=$search_term&redirects")
extract=$(echo "$page_content" | grep -o '"extract":".*' | sed 's/"extract":"//' | sed 's/"}}}}//')

# Check if the extract is empty
if [ -z "$extract" ]; then
  echo "No information found for '$search_term' on Wikipedia."
else
  echo -e "$extract"
fi
